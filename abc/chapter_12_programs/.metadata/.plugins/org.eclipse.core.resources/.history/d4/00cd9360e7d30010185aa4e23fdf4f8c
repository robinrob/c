/* Uses pipes to sum N rows concurrently. */

#include <stdio.h>
#include <stdlib.h>

#define N 3

int add_vector(int v[]);
void error_exit(char *s);
int fork(void);
int pipe(int pd[2]);
int read(int fd, void *buf, unsigned len);
int write(int fd, void *buf, unsigned len);

int main(void)
{
	int a[N][N] = {{1, 1, 1}, {2, 2, 2}, {3, 3, 3}},
			i, row_sum, sum = 0,
			pd[2];

	if (pipe(pd) == -1) {
		error_exit("pipe() failed\n");
	}
	for (i = 0; i < N; ++i) {
		if (fork() == 0) {
			rowm_sum = add_vector(a[i]);
		}
	}
}
